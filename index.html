<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ヴィジュネル暗号解読実験</title>
    <link rel="stylesheet" href="style.css"> 
</head>
<body>

    <main>
        <h1>ヴィジュネル暗号解読実験</h1>

        <section id="start-screen">
            <h2>実験参加へようこそ</h2>
            <p>この実験は、暗号解読プロセスにおける人間の行動パターンを調査するものです。</p>
            <p>準備ができたら、以下のボタンを押して開始してください。開始するとタイマーが作動します。</p>
            <button id="start-button">実験を開始する</button>
        </section>

        <section id="experiment-screen" style="display: none;">
            
            <button class="accordion-header" id="rule-accordion-button">
                実験のルールと心構え (クリックで開閉) ⚠️ 実験中はリロードしないでください
            </button>
            <div class="accordion-content open">
                <p style="font-weight: bold;">【重要】実験中は、ブラウザの再読み込み（リロード）を行わないでください。</p>
                <p>この暗号は**ヴィジュネル暗号**です。解読の鍵と元の文章（平文）を入力してください。</p>
                <p>暗号の基本原理は「鍵の文字に応じて、アルファベットを周期的に**ずらす**」ことです。<br>
                    <span style="color: #c0392b; font-weight: bold;">※ 鍵文字 'A' はシフト量「0」を意味し、文字をずらしません。'B' が1シフト、'Z' が25シフトとなります。</span>
                </p>
                <p>インターネット検索（Google等）やメモ帳などの**外部ツールの利用は自由**ですが、その利用状況は記録されます。</p>
            </div>
            <hr>

            <h2>暗号文:</h2>
            <div id="ciphertext-display">暗号文を生成中...</div>

            <div class="hint-area" style="margin-top: 20px; margin-bottom: 20px;">
                <button id="hint-button-1">💡 ヒント 1 (解読の第一歩)</button>
                <button id="hint-button-2" style="display: none;">💡 ヒント 2 (解読の具体的な手順)</button>
                
                <button id="frequency-tool-button">📊 頻度分析ツール</button>
                <button id="decryption-tool-button">🔓 復号化ツール</button>
            </div>
            
            <p id="hint-display-1" class="hint-message" style="display: none;"></p>
            <p id="hint-display-2" class="hint-message" style="display: none;"></p>
            
            <button class="accordion-header" id="tool-guide-accordion-button" style="margin-top: 20px;">
                ツールの使い方ガイド (クリックで開閉)
            </button>
            <div class="accordion-content">
                <h3>📊 頻度分析ツール</h3>
                <ul>
                    <li>**Kasiskiヒント:** 暗号文の繰り返し間隔から**鍵の長さの候補**を推測できます。間隔の**約数**に注目してください。</li>
                    <li>**鍵長で分析:** 推測した鍵長を入力すると、暗号文が分割され、鍵文字ごとの頻度グラフが表示されます。</li>
                </ul>
                <h3>🔓 復号化ツール</h3>
                <ul>
                    <li>特定した**鍵**を入力すると、平文全体が表示され、解読結果が正しいか**確実に確認できます**。</li>
                </ul>
            </div>
            <hr>

            <div id="decryption-interface">
                <h2>あなたの解読結果</h2>
                <label for="key-input">鍵:</label>
                <input type="text" id="key-input" placeholder="例: CIPHER (アルファベットのみ)">

                <label for="plaintext-input">元の文章（平文）:</label>
                <textarea id="plaintext-input" rows="5" placeholder="解読した元の文章をすべて大文字で入力してください (アルファベットのみ)"></textarea>

                <div style="margin-top: 15px;">
                    <button id="submit-button">結果を提出し、チェック</button>
                    <button id="giveup-button" class="secondary-button">ギブアップ</button>
                </div>
                
                <p id="message-area" style="margin-top: 10px; font-size: 1.1em; font-weight: bold; color: #d35400;"></p>
            </div>
        </section>

        <section id="survey-screen" style="display: none;">
            <h2>実験終了：アンケートとデータ送信</h2>

            <div class="survey-form">
                <h3>1. 暗号解読の経験</h3>
                <p>この実験以前に、ヴィジュネル暗号やその他の暗号解読の経験はありますか？</p>
                <label><input type="radio" name="knowledge" value="NONE" checked> 全くない</label>
                <label><input type="radio" name="knowledge" value="LITTLE"> 少しある（パズル程度）</label>
                <label><input type="radio" name="knowledge" value="MUCH"> 詳しい知識がある</label>
                
                <h3>2. 実験の楽しさ</h3>
                <p>この暗号解読タスクは楽しめましたか？</p>
                <label><input type="radio" name="enjoyment" value="LOW"> あまり楽しくなかった</label>
                <label><input type="radio" name="enjoyment" value="MEDIUM"> どちらでもない</label>
                <label><input type="radio" name="enjoyment" value="HIGH" checked> 非常に楽しめた</label>
            </div>
            
            <hr>
            
            <button id="send-data-button">研究データを送信する</button>
            <p id="data-status" style="margin-top: 10px; font-weight: bold;"></p>

        </section>
    </main>

    <script src="script.js"></script>
</body>
</html>
